# Next.js Note fr App Router

- Scaffold a project with [Next.js](https://nextjs.org/), [Ant Design](https://ant.design/) and [Tailwind CSS](https://tailwindcss.com/)
- Use App Router

- [Next.js Note fr App Router](#nextjs-note-fr-app-router)
  - [CLI](#cli)
  - [FILES](#files)
    - [`.env`](#env)
    - [`.eslintrc.json`](#eslintrcjson)
    - [`.npmrc`](#npmrc)
    - [`.prettierignore`](#prettierignore)
    - [`next.config.js`](#nextconfigjs)
    - [`package.json`](#packagejson)
    - [`postcss.config.js`](#postcssconfigjs)
    - [`tailwind.config.ts`](#tailwindconfigts)
    - [`app/layout.tsx`](#applayouttsx)
    - [`app/page.tsx`](#apppagetsx)
    - [`app/template.tsx`](#apptemplatetsx)

## CLI

```sh
npx -y create-next-app@latest next-app --ts --no-tailwind --eslint --use-npm --no-src-dir --app --import-alias "@/*"
```

```sh
cd next-app
```

```sh
npm i -P --save \
@types/node@latest \
@types/react@latest \
@types/react-dom@latest \
next@latest \
react@latest \
react-dom@latest \
eslint@latest \
eslint-config-next@latest \
eslint-config-prettier@latest \
typescript@latest \
antd@latest \
@ant-design/cssinjs@latest \
dayjs@latest \
dotenv-cli@latest \
tailwindcss@latest \
postcss@latest \
autoprefixer@latest \
prettier@latest \
sirv-cli@latest
```

```sh
npx tailwindcss init -p --ts
```

```sh
rm app/globals.css app/page.module.css
```

```sh
touch .env .npmrc .prettierignore app/template.tsx
```

```sh
code .
```

## FILES

### `.env`

```dotenv
PORT=3000
NEXT_TELEMETRY_DISABLED=1
```

### `.eslintrc.json`

```json
{
  "extends": ["next/core-web-vitals", "prettier"]
}
```

### `.npmrc`

```npmrc
audit=false
fund=false
loglevel=error
update-notifier=false
engine-strict=true
save=true
```

### `.prettierignore`

```ignore
.next
next-env.d.ts
/public
/out
```

### `next.config.js`

```js
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: process.env.STATIC ? "export" : undefined,
  reactStrictMode: true,
  images: {
    unoptimized: process.env.STATIC ? true : false,
  },
  compiler: {
    removeConsole: process.env.NODE_ENV === "production",
  },
};

module.exports = nextConfig;
```

### `package.json`

```json
{
  "scripts": {
    "dev": "dotenv next dev",
    "build": "dotenv next build",
    "export": "dotenv -v STATIC=1 next build",
    "preview": "dotenv sirv out",
    "start": "dotenv next start",
    "lint": "dotenv next lint",
    "format": "prettier '**/*' --write --ignore-unknown --cache"
  }
}
```

### `postcss.config.js`

```js
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};
```

### `tailwind.config.ts`

```ts
import type { Config } from "tailwindcss";

export default {
  important: "#__next",
  content: ["./app/**/*.{js,ts,jsx,tsx}", "./components/**/*.{js,ts,jsx,tsx}"],
  theme: {
    extend: {
      colors: {
        primary: "#722ed1",
      },
    },
  },
  plugins: [],
} satisfies Config;
```

### `app/layout.tsx`

```tsx
import { Metadata } from "next";

export const metadata: Metadata = {
  title: "Next + TailwindCSS + Antd",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body id="__next">{children}</body>
    </html>
  );
}
```

### `app/page.tsx`

```tsx
"use client";
import {
  App as AntApp,
  DatePicker,
  Descriptions,
  Space,
  Tag,
  version,
} from "antd";
import Image from "next/image";

export default function Home() {
  const { message } = AntApp.useApp();
  return (
    <div className="flex h-screen flex-col items-center justify-center gap-3 text-center">
      <a
        className="relative block h-[10vmin] w-[20vmin]"
        href="https://nextjs.org/"
        target="_blank"
        rel="noreferrer"
      >
        <Image
          src="/next.svg"
          className="pointer-events-none mb-10"
          alt="Vercel logo"
          fill
          priority
        />
      </a>
      <h1 className="text-3xl font-bold text-primary">
        Vite + React + TailwindCSS + antd
      </h1>
      <Descriptions bordered>
        <Descriptions.Item label="antd">
          <Space>
            <Tag color="processing">{version}</Tag>
            <DatePicker
              onChange={(date) => {
                if (!date) return;
                message.info(date?.toDate().toLocaleString());
              }}
            />
          </Space>
        </Descriptions.Item>
      </Descriptions>
    </div>
  );
}
```

### `app/template.tsx`

```tsx
"use client";
import { App as AntApp, ConfigProvider } from "antd";
import zhTW from "antd/locale/zh_TW";
import "dayjs/locale/zh-tw";
import dynamic from "next/dynamic";
import "tailwindcss/tailwind.css";
import tailwindConfig from "../tailwind.config";

const StyleProvider = dynamic(
  () => import("@ant-design/cssinjs").then((mod) => mod.StyleProvider),
  { ssr: false }
);

const PRIMARY_COLOR = tailwindConfig.theme.extend.colors.primary;

export default function Template({ children }: { children: React.ReactNode }) {
  return (
    <StyleProvider hashPriority="high">
      <ConfigProvider
        getPopupContainer={() =>
          document.getElementById("__next") as HTMLBodyElement
        }
        locale={zhTW}
        theme={{
          token: {
            colorPrimary: PRIMARY_COLOR,
            colorInfo: PRIMARY_COLOR,
            colorLink: PRIMARY_COLOR,
            colorLinkHover: PRIMARY_COLOR,
            colorLinkActive: PRIMARY_COLOR,
          },
        }}
      >
        <AntApp>{children}</AntApp>
      </ConfigProvider>
    </StyleProvider>
  );
}
```
